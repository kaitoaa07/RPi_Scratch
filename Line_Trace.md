
# ライントレース拡張マニュアル

このドキュメントでは、Scratch×Raspberry Pi 環境でライントレース制御を行うための拡張ブロックの使い方を解説します。

## 1. 概要
ライン（白線または黒線）を光センサーで追跡し、モーター制御によってロボットを自律走行させるテクニックを「ライントレース」と呼びます。
本拡張では、Scratch上で簡単にライントレースロジックを組めるように、以下のブロックを提供します。

### 参考記事・資料
。。。。。。。

## 2. 用意しているブロック一覧
| ブロック                          | 機能説明                                     |
|---------------------------------|--------------------------------------------|
| `サーバーに接続する`              | 拡張機能を動作させるためのサーバーへ接続           |
| `センサー[ ]の状態を取得(0/1)`      | 光センサーの値(0=白 / 1=黒)をScratchに返却       |
| `LED[ ]の明るさを◯%にする`        | 指定したLEDを指定光度で点灯                      |
| `すべてのLEDを消灯`               | すべてのLEDを消灯                              |
| `モーター[ ]を速度( )%に設定`      | 指定モーターを指定速度で前進                     |
| `モーター[ ]を停止する`            | 指定モーターを即時停止                          |

## 3. 前提条件
- SDカードから起動済みのPiで、拡張サーバーがバックグラウンド起動していること
- 光センサーがライン検知位置に取り付け済みであること
- モーター左右2台が接続済みであること

## 4. 初期化手順
1. ブラウザで `http://<PiのIP>:8601` を開く
2. Scratchエディタにライントレース拡張を追加
3. 最初に必ず「サーバーに接続する」ブロックを実行

## 5. サンプルスクリプト
以下は、左と右の2つの光センサーを使ったシンプルなライントレース例です。
```scratch
when green flag clicked
  サーバーに接続する
  forever
    if <センサー[左]の状態を取得 = 1> then
      # 黒ライン検知：左側がライン上 -> 右に旋回
      モーター[左]を速度(30)%に設定
      モーター[右]を速度(60)%に設定
    else if <センサー[右]の状態を取得 = 1> then
      # 黒ライン検知：右側がライン上 -> 左に旋回
      モーター[左]を速度(60)%に設定
      モーター[右]を速度(30)%に設定
    else
      # 双方白：直進
      モーター[左]を速度(50)%に設定
      モーター[右]を速度(50)%に設定
    end
  end
````

## 6. LEDデバッグ

ライン検知を視覚的に確認したい場合は、検知時にLEDを点灯させると便利です。

```scratch
if <センサー[左]の状態を取得 = 1> then
  LED[1]の明るさを100%にする
else
  LED[1]の明るさを0%にする
end
```

## 7. 注意点／トラブルシューティング

- **接続エラー**: サーバー接続失敗時はIP・ポート(8601)を再確認
- **センサー値が安定しない**: 周囲照明の影響を避けるためシールドを取り付け
- **モーター動作異常**: 電源電圧やモータードライバの配線を再確認

```

